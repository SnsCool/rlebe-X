# rlebe-X Bot コマンド一覧

## 集計対象について

- **集計チャンネル:** 「レベッター」チャンネル内の投稿が対象
- **いいね数（もらった数）:** メンバーが「レベッター」チャンネルに投稿した内容に対して、他のメンバーが付けた ❤️ リアクションの合計数
- **いいねした回数:** メンバーが他の人の投稿に対して ❤️ リアクションを押した回数（自分が誰かの投稿にいいねした合計）
- **投稿数:** メンバーが「レベッター」チャンネルに投稿したメッセージの総数（Bot投稿は除外）

---

## よく使うコマンド

### `/like_stats` - いいね詳細統計

「レベッター」チャンネルの投稿に付いた ❤️ リアクションを、**個人別**・**部署別**・**トップ10投稿**の3視点で集計し、CSVファイルをDMで送信。

先月のいいね統計:
```
/like_stats period:last
```

2025年1月のいいね統計:
```
/like_stats period:2025-01
```

2025年2月のいいね統計:
```
/like_stats period:2025-02
```

2ヶ月前のいいね統計:
```
/like_stats period:-2
```

3ヶ月前のいいね統計:
```
/like_stats period:-3
```

全期間のいいね統計:
```
/like_stats period:all
```

**CSV出力内容（3セクション横並び）:**

| セクション | 列 | 説明 |
|-----------|-----|------|
| 個人別 | 部署 / 名前 / いいねした回数 / いいねもらった数 / 投稿数 | メンバーごとに「自分が他の人の投稿に❤️を押した回数」と「自分の投稿に❤️をもらった数」を表示 |
| 部署別 | 部署 / 部署別投稿数 / 部署別いいねもらった数 | 部署ごとの合計投稿数と、部署メンバーの投稿がもらった❤️の合計 |
| トップ10投稿 | 順位 / 投稿者 / いいね数 / 投稿日時 / 投稿内容 | ❤️リアクションが多かった投稿のランキング（最大10件、投稿内容の先頭100文字を表示） |

---

### `/ai_report` - 本気AI提出レポート

「本気AI」プロジェクトの提出スレッドに投稿された内容を集計。ユーザー別の提出回数・月別内訳をCSVでDMに送信。

先月の本気AI提出レポート:
```
/ai_report period:last
```

2025年1月の本気AI提出レポート:
```
/ai_report period:2025-01
```

2025年2月の本気AI提出レポート:
```
/ai_report period:2025-02
```

2ヶ月前の本気AI提出レポート:
```
/ai_report period:-2
```

3ヶ月前の本気AI提出レポート:
```
/ai_report period:-3
```

全期間の本気AI提出レポート:
```
/ai_report period:all
```

---

## その他のコマンド

### `/report` - 月次レポート

「レベッター」チャンネルの投稿に付いた ❤️ リアクション数と投稿数を月単位で集計。未投稿メンバーも0で記載される。CSVファイルをDMで送信。

先月のレポート（デフォルト）:
```
/report
```

2025年1月のレポート:
```
/report period:2025-01
```

全期間のレポート:
```
/report period:all
```

**CSV出力:**

| 列 | 説明 |
|----|------|
| 部署 | メンバーの所属部署 |
| 名前 | メンバー名 |
| いいね数 | その人の投稿がもらった❤️の合計 |
| いいねした回数 | その人が他の人の投稿に❤️を押した回数 |
| 投稿数 | その人の投稿メッセージ数 |
| 平均いいね数 | いいね数 ÷ 投稿数 |
| 全体いいね数 | 全メンバーのいいね合計（先頭行のみ表示） |
| 全体投稿数 | 全メンバーの投稿合計（先頭行のみ表示） |

---

### `/date_report` - 日時範囲レポート

「レベッター」チャンネルの投稿を、特定の日時範囲を指定して集計。時間単位の細かい指定が可能。CSVファイルをDMで送信。

2/15 の 11:16〜23:59:
```
/date_report start:2025-02-15 11:16 end:2025-02-15 23:59
```

1/10〜1/20 の全日:
```
/date_report start:2025-01-10 00:00 end:2025-01-20 23:59
```

2月全体:
```
/date_report start:2025-02-01 00:00 end:2025-02-28 23:59
```

2/1 の営業時間内:
```
/date_report start:2025-02-01 09:00 end:2025-02-01 18:00
```

---

### `/lunch_report` - ランチ制度レポート

ランチ制度の利用状況を集計（イベント数・参加者数・参加率・合計金額）。CSVファイルをDMで送信。

先月のランチレポート:
```
/lunch_report period:last
```

2025年1月のランチレポート:
```
/lunch_report period:2025-01
```

2ヶ月前のランチレポート:
```
/lunch_report period:-2
```

全期間のランチレポート:
```
/lunch_report period:all
```

---

### `/ask` - AI自然言語クエリ

自然言語で質問すると、AIが意図を解析して「レベッター」チャンネルの❤️リアクション・投稿数を集計。

先月の全体レポート:
```
/ask query:先月のレポート
```

佐藤くんの投稿がもらった❤️の合計:
```
/ask query:佐藤くんのいいね数
```

日時範囲指定で集計:
```
/ask query:2/15 11:16〜23:59のいいね数
```

月指定 + ユーザー指定:
```
/ask query:1月の田中さんのハート数
```

---

### `/channel_info` - チャンネル情報表示

設定されているチャンネル・スレッドの情報を確認（デバッグ用）。パラメータなし。

```
/channel_info
```

---

## 期間指定フォーマット（共通）

| 形式 | 説明 | 例 |
|------|------|----|
| `YYYY-MM` | 特定の年月 | `2025-01` → 2025年1月 |
| `last` | 先月 | 今が2月なら1月 |
| `-N` | Nヶ月前 | `-2` → 2ヶ月前, `-3` → 3ヶ月前 |
| `all` | 全期間 | 全データを集計 |

## 権限

全コマンドは **管理者（ALLOWED_USER_IDS）** のみ実行可能です。

## 出力方法

全レポートは **DMにCSVファイルとして送信** されます（DMの受信設定をオンにしてください）。
